<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<!-- Usando el fragmento de head del layout base -->
<head th:replace="~{fragments/layout/base-layout :: head('Nueva Solicitud - Reciclaje Sólido', ~{::extraStyles})}">
    <title>Nueva Solicitud - Reciclaje Sólido</title>
    <!-- Estilos adicionales específicos de esta página -->
    <th:block th:fragment="extraStyles">
        <!-- Aquí irían estilos específicos de la página si fueran necesarios -->
    </th:block>
</head>

<!-- Usando el layout base con el contenido específico de esta página -->
<div th:replace="~{fragments/layout/base-layout :: layout('Nueva Solicitud', ~{::main-content}, ~{::page-scripts})}">
    
    <!-- Contenido principal específico de esta página -->
    <div th:fragment="main-content">
        <!-- Eliminamos la línea duplicada de breadcrumbs ya que está en base-layout -->
        
        <!-- Sección de formulario de nueva solicitud -->
        <section>
            <div class="glass-card">
                <div class="flex items-center mb-6">
                    <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center mr-3">
                        <i class="bi bi-plus-circle text-green-600 text-2xl"></i>
                    </div>
                    <h1 class="text-3xl font-bold">Nueva Solicitud de Reciclaje</h1>
                </div>
                
                <form th:action="@{/user/newsolicitude}" method="post" th:object="${solicitud}" enctype="multipart/form-data" class="space-y-4">
                    <!-- Selección de Organización -->
                    <div class="mb-4">
                        <label for="organization" class="block text-sm font-medium text-gray-700 mb-1">
                            Organización Destinataria <span class="text-red-500">*</span>
                        </label>
                        <select id="organization" th:field="*{organization}" 
                                class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                required>
                            <option value="">Seleccione una organización</option>
                            <option th:each="org : ${organizations}" th:value="${org.id}" th:text="${org.name}"></option>
                        </select>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Primera columna -->
                        <div class="space-y-4">
                            <!-- Tipo de material -->
                            <div>
                                <label for="categoria" class="block text-sm font-medium text-gray-700 mb-1">
                                    Tipo de Material <span class="text-red-500">*</span>
                                </label>
                                <select id="categoria" th:field="*{categoria}" 
                                        class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                        required>
                                    <option value="">Seleccione una categoría</option>
                                    <option value="PLASTICO">Plástico</option>
                                    <option value="PAPEL">Papel</option>
                                    <option value="VIDRIO">Vidrio</option>
                                    <option value="METAL">Metal</option>
                                    <option value="ELECTRONICO">Electrónico</option>
                                    <option value="ORGANICO">Orgánico</option>
                                    <option value="OTROS">Otros</option>
                                </select>
                                <p th:if="${#fields.hasErrors('categoria')}" th:errors="*{categoria}" 
                                   class="mt-1 text-sm text-red-600"></p>
                            </div>
                            
                            <!-- Peso y Tamaño en la misma fila -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label for="peso" class="block text-sm font-medium text-gray-700 mb-1">
                                        Peso (kg) <span class="text-red-500">*</span>
                                    </label>
                                    <input type="number" id="peso" th:field="*{peso}" step="0.01" min="0.01" 
                                           class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                           required>
                                </div>
                                <div>
                                    <label for="tamanio" class="block text-sm font-medium text-gray-700 mb-1">
                                        Tamaño <span class="text-red-500">*</span>
                                    </label>
                                    <select id="tamanio" th:field="*{tamanio}" 
                                            class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                            required>
                                        <option value="">Seleccione</option>
                                        <option value="PEQUEÑO">Pequeño</option>
                                        <option value="MEDIANO">Mediano</option>
                                        <option value="GRANDE">Grande</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Imagen -->
                            <div>
                                <label for="fileInput" class="block text-sm font-medium text-gray-700 mb-1">
                                    Imagen <span class="text-red-500">*</span>
                                </label>
                                <input type="file" id="fileInput" name="file" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"
                                       accept="image/*" required>
                            </div>
                        </div>
                        
                        <!-- Segunda columna -->
                        <div class="space-y-4">
                            <!-- Descripción -->
                            <div>
                                <label for="descripcion" class="block text-sm font-medium text-gray-700 mb-1">
                                    Descripción <span class="text-red-500">*</span>
                                </label>
                                <textarea id="descripcion" th:field="*{descripcion}" rows="2"
                                          class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                          required></textarea>
                                <p th:if="${#fields.hasErrors('descripcion')}" th:errors="*{descripcion}" 
                                   class="mt-1 text-sm text-red-600"></p>
                            </div>
                            
                            <!-- Teléfono y dirección en la misma fila -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label for="telefono" class="block text-sm font-medium text-gray-700 mb-1">
                                        Teléfono <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="telefono" th:field="*{telefono}" 
                                           class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                           placeholder="Ej: 099123456" required>
                                </div>
                                <div>
                                    <label for="calle" class="block text-sm font-medium text-gray-700 mb-1">
                                        Calle <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="calle" th:field="*{calle}" 
                                           class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                           required>
                                </div>
                            </div>
                            
                            <!-- Número, barrio y destino en la misma fila -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label for="numeroDeCasa" class="block text-sm font-medium text-gray-700 mb-1">
                                        Número <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="numeroDeCasa" th:field="*{numeroDeCasa}" 
                                           class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                           required>
                                </div>
                                <div>
                                    <label for="barrio" class="block text-sm font-medium text-gray-700 mb-1">
                                        Barrio <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="barrio" th:field="*{barrio}" 
                                           class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                           required>
                                </div>
                            </div>
                            <div>
                                <label for="destino" class="block text-sm font-medium text-gray-700 mb-1">
                                    Destino <span class="text-red-500">*</span>
                                </label>
                                <input type="text" id="destino" th:field="*{destino}" 
                                       class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                       placeholder="Ej: Punto de reciclaje" required>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Días y horarios en la misma fila -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label for="diasDisponibles" class="block text-sm font-medium text-gray-700 mb-1">
                                Días Disponibles <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="diasDisponibles" th:field="*{diasDisponibles}" 
                                   class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                   placeholder="Ej: Lunes, Miércoles y Viernes" required>
                        </div>
                        
                        <div>
                            <label for="horaRecoleccion" class="block text-sm font-medium text-gray-700 mb-1">
                                Horario <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="horaRecoleccion" th:field="*{horaRecoleccion}" 
                                   class="block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"
                                   placeholder="Ej: 9:00 a 12:00" required>
                        </div>
                    </div>
                    
                    <!-- Botones de acción -->
                    <div class="flex justify-end space-x-3 pt-4">
                        <a th:href="@{/user/welcome}" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            <i class="bi bi-arrow-left mr-2"></i> Cancelar
                        </a>
                        <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            <i class="bi bi-send mr-2"></i> Enviar
                        </button>
                    </div>
                </form>
            </div>
        </section>
    </div>

    <!-- Scripts específicos de esta página -->
    <th:block th:fragment="page-scripts">
        <script>
            // Script para previsualizar la imagen subida
            document.addEventListener('DOMContentLoaded', function() {
                const fileInput = document.getElementById('fileInput');
                
                fileInput.addEventListener('change', function() {
                    const file = this.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // Puedes agregar código aquí para mostrar una vista previa si lo deseas
                            console.log('Imagen cargada');
                        };
                        reader.readAsDataURL(file);
                    }
                });
            });
        </script>
    </th:block>
</div>
</html>
